#:kivy 2.3.0


<CustomToggleButton>
    group: "mode"
    font_size: "32sp"


<Start_Menu>:
    name: "start_menu"

    mode_label: mode_label
    training_button: training_button
    game_button: game_button
    browse_button: browse_button
    # images_button: images_button

    questions_label: questions_label
    firetrucks_button: firetrucks_button
    competitions_button: competitions_button
    # standards_button: standards_button

    info_button: info_button
    settings_button: settings_button
    
    Button:
        id: info_button
        font_size: "32sp"
        size_hint: None, None
        size: "150dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "info_screen"
            root.manager.transition.direction = "left"
            root.update_info_scores()

    Button:
        id: settings_button
        font_size: "32sp"
        size_hint: None, None
        size: "150dp", "50dp"
        pos_hint: {'right': 1, 'top': 1}
        on_release:
            app.root.current = "settings_screen"
            root.manager.transition.direction = "left"

    BoxLayout:
        orientation: "vertical"
        spacing: "3dp"

        Label:  # placeholder
            size_hint: 1, 0.5
            text: ""

        Label:
            id: mode_label
            bold: True
            font_size: "32sp"
            size_hint: 0.5, 0.5
        
        ##-- Removed before testing release as images is not working yet
        #GridLayout:
        #    size_hint: 1, 2
        #    cols: 2
        #    spacing: "3dp"
        #
        #    CustomToggleButton:
        #        id: training_button
        #        state: "down"
        #        on_release: root.on_button_release()
        #
        #    CustomToggleButton:
        #        id: game_button
        #        on_release: root.on_button_release()
        #    
        #    CustomToggleButton:
        #        id: browse_button
        #        on_release: root.on_button_release()
        #
        #    CustomToggleButton:
        #        id: images_button
        #        on_release: root.on_button_release()
        ##-- 
        CustomToggleButton:
            id: training_button
            state: "down"
            on_release: root.on_button_release()
    
        CustomToggleButton:
            id: game_button
            on_release: root.on_button_release()
        
        CustomToggleButton:
            id: browse_button
            on_release: root.on_button_release()
        ##--

        Label:  # placeholder
            size_hint: 1, 0.5
            text: ""
        
        Label:
            id: questions_label
            bold: True
            font_size: "32sp"
            size_hint: 0.4, 0.5
        
        Button:
            id: firetrucks_button
            font_size: "32sp"
            on_release:
                app.root.current = "fahrzeugkunde_menu"
                root.manager.transition.direction = "left"
                root.forward_mode2menu("fahrzeugkunde_menu")

        Button:
            id: competitions_button
            font_size: "32sp"
            on_release:
                app.root.current = "bewerb_menu"
                root.manager.transition.direction = "left"
                root.forward_mode2menu("bewerb_menu")
        
        ###- Removed before 'testing release' as no content yet
        #Button:
        #    id: standards_button
        #    font_size: "32sp"
        #    on_release:
        #        app.root.current = "standardsmenu"
        #        root.manager.transition.direction = "left"
        #        root.forward_mode2menu("standardsmenu")
        ###-


<Info_Screen>:
    name: "info_screen"

    about_label: about_label
    scores_label: scores_label

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "start_menu"
            root.manager.transition.direction = "right"
    
    BoxLayout:
        orientation: 'vertical'

        Label:
            id: about_label
            font_size: "15sp"
            halign: "center"
            size_hint: 1, 1
        
        #Label: 
        #    # separator
        #    text: "----------------------------------------------------------"
        #    size_hint: 1, 0.1
        
        Label:
            id: scores_label
            font: "Courier New"
            font_size: "15sp"
            halign: "left"
            markup: True
            size_hint: 1, 4
        

<Settings_Screen>:
    name: "settings_screen"

    text_output: text_output
    upload_confirm_button: upload_confirm_button
    default_content_switch: default_content_switch

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "start_menu"
            root.manager.transition.direction = "right"
    
    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            orientation: 'horizontal'

            Label:
                text: 'Standardinhalte nutzen'
                font_size: "32sp"
            
            Switch:
                id: default_content_switch
                active: True
                disabled: True

        Button:
            text: 'Datei auswählen'
            font_size: "32sp"
            size_hint: 1, 1
            on_release: root.show_load()

        Button:
            id: upload_confirm_button
            text: 'Bestätigen'
            font_size: "32sp"
            disabled: True
            on_release: 
            size_hint: 1, 1
            on_release:
                root.confirm_upload()
        
        Label:
            #placeholder
            size_hint: 1, 0.1

        Label:
            id: text_output
            text: ""
            font_size: "23sp"
            text_size: self.size
            valign: "top"
            halign: "left"
            show_errors: True
            markup: True
            size_hint: 1, 6


<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserListView:
            id: filechooser
            filters: ['*.yaml', '*.yml']
            size_hint: 1, 6

        BoxLayout:
            size_hint: 1, 1

            Button:
                text: "Abbrechen"
                font_size: "32sp"
                on_release: 
                    root.cancel()

            Button:
                text: "Auswählen"
                font_size: "32sp"
                on_release:
                    root.load(filechooser.path, filechooser.selection)


<Fahrzeugkunde_Menu>:
    name: "fahrzeugkunde_menu"
    mode_label: mode_label
    firetrucks_layout: firetrucks_layout

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "start_menu"
            root.manager.transition.direction = "right"

    Label:
        id: mode_label
        font_size: "20sp"
        size_hint: None, None
        size: "200dp", "50dp"
        halign: "right"
        text_size: self.width, None
        pos_hint: {'right': 1, 'top': 1}
    
    ScrollView:
        size_hint: 1, 0.9
        BoxLayout:
            id: firetrucks_layout
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height
            spacing: "5dp"


<Bewerb_Menu>:
    name: "bewerb_menu"
    #orientation: "vertical"
    mode_label: mode_label
    bewerbe_layout: bewerbe_layout

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "start_menu"
            root.manager.transition.direction = "right"

    Label:
        id: mode_label
        font_size: "20sp"
        size_hint: None, None
        size: "200dp", "50dp"
        halign: "right"
        text_size: self.width, None
        pos_hint: {'right': 1, 'top': 1}
    
    ScrollView:
        size_hint: 1, 0.9
        BoxLayout:
            id: bewerbe_layout
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height
            spacing: "5dp"


<Fahrzeugkunde_Training>:
    name: "fahrzeugkunde_training"
    firetruck_label: firetruck_label
    strike_label: strike_label
    high_strike_label: high_strike_label
    tool_label: tool_label
    firetruck_rooms_layout: firetruck_rooms_layout

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "fahrzeugkunde_menu"
            root.manager.transition.direction = "right"
    
    #Label:
    #    id: firetruck_label
    #    font_size: "20sp"
    #    pos_hint: {'left': 1, 'top': 1}
    #    text_size: self.width, None
    #    halign: "left"
    #    size_hint: 1, 0.25
    Label:
        id: firetruck_label
        size_hint: None, None
        size: "200dp", "50dp"
        pos_hint: {'x': 0.1, 'top': 1}
        halign: "left"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"

    #Label:
    #    id: strike_label
    #    # text: '0'
    #    text: ''
    #    size_hint: 0.1, 0.25
    #    pos_hint: {'right': 1, 'top': 1}
    #    text_size: self.width, None
    #    font_size: "25sp"
    #    # halign: "right"
    Label:
        id: strike_label
        text: ''
        size_hint: None, None
        size: '70dp', '50dp'
        pos_hint: {'center_x': 0.5, 'top': 1}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "25sp"
    
    #Label:
    #    id: high_strike_label
    #    text: ''
    #    font_size: "20sp"
    #    pos_hint: {'right': 1, 'top': 1}
    #    text_size: self.width, None
    #    halign: "right"
    #    size_hint: 1, 0.05
    Label:
        id: high_strike_label
        text: ''
        size_hint: None, None
        size: "500dp", "50dp"
        pos_hint: {'right': 1, 'top': 1}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"

    BoxLayout:
        orientation: 'vertical'

        Label:  # placeholder
            size_hint: 1, 0.15

        Label:
            id: tool_label
            # size_hint: 1, 0.3
            size_hint: 1, 1.1
            font_size: "28sp"

        GridLayout:
            id: firetruck_rooms_layout
            # size_hint: 1, 0.7
            size_hint: 1, 2
            spacing: "3dp"
            cols: 2


<Fahrzeugkunde_Game>:
    name: "fahrzeugkunde_game"
    firetruck_label: firetruck_label
    timer_label: timer_label
    extra_time_label: extra_time_label
    score_label: score_label
    high_score_label: high_score_label
    tool_label: tool_label
    firetruck_rooms_layout: firetruck_rooms_layout
    progress_bar: progress_bar
    
    Button:
        text: "<"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'x': 0, 'top': 1}
        font_size: "32sp"
        on_release:
            root.manager.get_screen('fahrzeugkunde_game').end_game()
            # app.root.current = "fahrzeugkunde_menu" # not needed
            # root.manager.transition.direction = "right"

    Label:
        id: firetruck_label
        size_hint: None, None
        size: "200dp", "50dp"
        pos_hint: {'x': 0.1, 'top': 1}
        halign: "left"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"

    Label:
        id: score_label
        text: ''
        size_hint: None, None
        size: '70dp', '50dp'
        pos_hint: {'center_x': 0.5, 'top': 1}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "25sp"
        # color: (0,1,0,1) if self.parent.timer_change_label_visible else (1,0,0,1)

    Label:
        id: high_score_label
        text: ''
        size_hint: None, None
        size: "500dp", "50dp"
        pos_hint: {'right': 1, 'top': 1}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"
    
    Label:
        id: extra_time_label
        size_hint: None, None
        size: '100dp', '50dp'
        pos_hint: {'right': 1, 'y': 0.80}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"
        color: (0,1,0,1)

    Label:
        id: timer_label
        size_hint: None, None
        size: '100dp', '50dp'
        pos_hint: {'right': 1, 'y': 0.75}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "22sp"
        # color: (0,1,0,1) if self.parent.timer_change_label_visible else (1,0,0,1)

    BoxLayout:
        orientation: 'vertical'

        Label:  # placeholder
            size_hint: 1, 0.15

        Label:
            id: tool_label
            size_hint: 1, 1
            font_size: "28sp"
        
        ProgressBar:
            id: progress_bar
            size_hint: 1, 0.1
            # color: green if added, red if reduced
        
        GridLayout:
            id: firetruck_rooms_layout
            size_hint: 1, 2
            spacing: "3dp"
            cols: 2


<Label_List>:
    name: label_list
    orientation: 'vertical'
    size_hint_y: None
    height: self.minimum_height


<Fahrzeugkunde_Browse>:
    name: "fahrzeugkunde_browse"
    firetruck_label: firetruck_label
    browse_scrollview: browse_scrollview
    filter_text: filter_text

    #Button:
    #    text: "<"
    #    font_size: "32sp"
    #    size_hint: None, None
    #    size: "50dp", "50dp"
    #    pos_hint: {'left': 1, 'top': 1}
    #    on_release:
    #        app.root.current = "fahrzeugkunde_menu"
    #        root.manager.transition.direction = "right"
    #
    #Label:
    #    id: firetruck_label
    #    font_size: "20sp"
    #    pos_hint: {'right': 1, 'top': 1}
    #    text_size: self.width, None
    #    halign: "right"
    #    size_hint: None, None
    #    size: "200dp", "50dp"
    Label:
        id: firetruck_label
        font_size: "20sp"
        pos_hint: {'center_x': 1, 'top': 1}
        text_size: self.width, None
        halign: "left"
        size_hint: 0.7, 0.25
    
    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, 0.1
            
            Label:  # placeholder
                size_hint: 0.2, 1
                text: ""

            TextInput:
                id: filter_text
                size_hint: 0.6, 1
                pos_hint: {'center_x': 0.5}
                text: ""
                text_size: self.width, None
                font_size: "25sp"
                multiline: False
            
            Button:
                size_hint: 0.3, 1
                text: "search"
                on_release:
                    root.manager.get_screen('fahrzeugkunde_browse').filter_list()

        Label:  # placeholder
            size_hint: 1, 0.1
            text: ""
        
        ScrollView:
            id: browse_scrollview
            size_hint: 0.9, 1
            pos_hint: {'center_x': 0.5}
            BoxLayout:
                id: label_list
                orientation: 'vertical'
                size_hint_y: None
                size_hint_x: None
                width: 1300
                height: self.minimum_height
    
    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "fahrzeugkunde_menu"
            root.manager.transition.direction = "right"


<Fahrzeugkunde_Images>:
    name: "fahrzeugkunde_images"
    firetruck_label: firetruck_label
    # firetruck_rooms_layout: firetruck_rooms_layout
    scatter: scatter

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "fahrzeugkunde_menu"
            root.manager.transition.direction = "right"
    
    BoxLayout:
        orientation: 'vertical'
        
        Label:
            id: firetruck_label
            text: "Bilder"
            font_size: "20sp"
            # pos_hint: {'center': 1, 'top': 1}
            text_size: self.width, None
            # halign: "left"
            # size_hint: 0.5, 0.1

        FloatLayout:
            # size_hint: 1, 0.8

            Scatter:
                id: scatter
                # size_hint: 1, 0.8
                do_rotation: False

        GridLayout:
            # size_hint: 1, 0.1
            spacing: "3dp"
            cols: 2
    
            Button:
                text: "<"
                id: previous_image_button
                font_size: "45sp"
                disabled: True
                # on_release:
                #     root.manager.get_screen('fahrzeugkunde_images').load_image()

            Button:
                text: ">"
                id: next_image_button
                font_size: "45sp"
                on_release:
                    root.manager.get_screen('fahrzeugkunde_images').load_image()


<Bewerb_Training>:
    name: "bewerb_training"
    question_id_label: question_id_label
    question_scrollview: question_scrollview
    question_label: question_label

    solution_button: solution_button
    random_question_button: random_question_button
    previous_question_button: previous_question_button
    next_question_button: next_question_button

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            app.root.current = "bewerb_menu"
            root.manager.transition.direction = "right"

    Label:
        id: question_id_label
        font_size: "32sp"
        halign: "right"
        size_hint: None, None
        size: "500dp", "50dp"
        text_size: self.width, None
        pos_hint: {'right': 1, 'top': 1}

    BoxLayout:
        orientation: 'vertical'

        Label:  # placeholder
            size_hint: 1, 0.1
            text: ""

        ScrollView:
            id: question_scrollview
            size_hint: 0.9, 0.65
            pos_hint: {'center_x': 0.5}
            Label:
                id: question_label
                font_size: "32sp"
                halign: "left"
                valign: "top"
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]
                markup: True

        GridLayout:
            size_hint: 1, 0.25
            spacing: "3dp"
            cols: 2
    
            Button:
                text: "<"
                id: previous_question_button
                font_size: "45sp"
                on_release:
                    root.manager.get_screen('bewerb_training').next_question(previous=True)

            Button:
                text: ">"
                id: next_question_button
                font_size: "45sp"
                on_release:
                    root.manager.get_screen('bewerb_training').next_question()

            Button:
                id: random_question_button
                font_size: "32sp"
                on_release:
                    root.manager.get_screen('bewerb_training').random_question()
        
            Button:
                id: solution_button
                font_size: "32sp"
                on_release:
                    root.manager.get_screen('bewerb_training').reveal_answer()


<Bewerb_Game>:
    name: "bewerb_game"
    competition_label: competition_label
    score_label: score_label
    high_score_label: high_score_label
    timer_label: timer_label
    extra_time_label: extra_time_label

    progress_bar: progress_bar
    question_id_label: question_id_label
    question_scrollview: question_scrollview
    question_label: question_label

    answer_buttons_layout: answer_buttons_layout

    Button:
        text: "<"
        font_size: "32sp"
        size_hint: None, None
        size: "50dp", "50dp"
        pos_hint: {'left': 1, 'top': 1}
        on_release:
            root.manager.get_screen('bewerb_game').end_game()
            # app.root.current = "bewerb_menu" # probably not needed
            # root.manager.transition.direction = "right"

    Label:
        id: competition_label
        size_hint: None, None
        size: "200dp", "50dp"
        pos_hint: {'x': 0.1, 'top': 1}
        halign: "left"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"
    
    Label:
        id: score_label
        text: ''
        size_hint: None, None
        size: '70dp', '50dp'
        pos_hint: {'center_x': 0.5, 'top': 1}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "25sp"

    Label:
        id: high_score_label
        text: ''
        size_hint: None, None
        size: "500dp", "50dp"
        pos_hint: {'right': 1, 'top': 1}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"

    Label:
        id: question_id_label
        font_size: "20sp"
        halign: "right"
        size_hint: None, None
        size: "500dp", "50dp"
        text_size: self.width, None
        pos_hint: {'right': 1, 'top': 0.95}
    

    Label:
        id: extra_time_label
        size_hint: None, None
        size: '100dp', '50dp'
        pos_hint: {'right': 1, 'y': 0.80}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "20sp"
        color: (0,1,0,1)

    Label:
        id: timer_label
        size_hint: None, None
        size: '100dp', '50dp'
        pos_hint: {'right': 1, 'y': 0.75}
        halign: "right"
        valign: "middle"
        text_size: self.size
        font_size: "22sp"
    
    BoxLayout:
        orientation: 'vertical'

        Label:  # placeholder
            size_hint: 1, 0.2
            #size_hint: 1, 0.05
        
        ProgressBar:
            id: progress_bar
            #size_hint: 1, 0.1
            size_hint: 1, 0.03
        
        ScrollView:
            id: question_scrollview
            # size_hint: 0.9, 0.65
            size_hint: 0.9, 1
            pos_hint: {'center_x': 0.5}
            Label:
                id: question_label
                font_size: "25sp"
                halign: "left"
                valign: "top"
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]
                markup: True
        
        GridLayout:
            id: answer_buttons_layout
            # size_hint: 1, 0.25
            size_hint: 1, 0.2
            spacing: "3dp"
            cols: 4

